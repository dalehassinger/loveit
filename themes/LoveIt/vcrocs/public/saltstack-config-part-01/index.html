<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>VMware vRealize SaltStack Config as a Windows Server Admin - Part 1 - vCROCS</title><meta name="Description" content="description"><meta property="og:title" content="VMware vRealize SaltStack Config as a Windows Server Admin - Part 1" />
<meta property="og:description" content="description" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dalehassinger.github.io/hugo-loveit/saltstack-config-part-01/" /><meta property="og:image" content="https://dalehassinger.github.io/hugo-loveit/saltstack-config-part-01/featured-image.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-16T00:00:00-05:00" />
<meta property="article:modified_time" content="2021-07-16T00:00:00-05:00" /><meta property="og:site_name" content="vCROCS" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://dalehassinger.github.io/hugo-loveit/saltstack-config-part-01/featured-image.png"/>
<meta name="twitter:title" content="VMware vRealize SaltStack Config as a Windows Server Admin - Part 1"/>
<meta name="twitter:description" content="description"/>
<meta name="application-name" content="vCROCS">
<meta name="apple-mobile-web-app-title" content="vCROCS"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://dalehassinger.github.io/hugo-loveit/saltstack-config-part-01/" /><link rel="next" href="https://dalehassinger.github.io/hugo-loveit/saltstack-config-part-02/" /><link rel="stylesheet" href="/hugo-loveit/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "VMware vRealize SaltStack Config as a Windows Server Admin - Part 1",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/dalehassinger.github.io\/hugo-loveit\/saltstack-config-part-01\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/dalehassinger.github.io\/hugo-loveit\/images\/Apple-Devices-Preview.png",
                            "width":  3200 ,
                            "height":  2048 
                        }],"genre": "regular","keywords": "Salt, SaltStack, SaltStack Config, Windows Server, PowerShell, VMware, vRealize, Configuration Management, Automation, VMware Aria","wordcount":  1193 ,
        "url": "https:\/\/dalehassinger.github.io\/hugo-loveit\/saltstack-config-part-01\/","datePublished": "2021-07-16T00:00:00-05:00","dateModified": "2021-07-16T00:00:00-05:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/dalehassinger.github.io\/hugo-loveit\/images\/avatar.png",
                    "width":  528 ,
                    "height":  560 
                }},"author": {
                "@type": "Person",
                "name": "| Dale Hassinger"
            },"description": "description"
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/hugo-loveit/" title="vCROCS"><span class="header-title-pre"><i class='far fa-house fa-solid'></i></span>vCROCS</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/hugo-loveit/about/"> About </a><a class="menu-item" href="/hugo-loveit/posts/"> Posts </a><a class="menu-item" href="/hugo-loveit/tags/"> Tags </a><a class="menu-item" href="/hugo-loveit/categories/"> Categories </a><a class="menu-item" href="/hugo-loveit/links/"><i class='fab fa-bookmark fa-regular' aria-hidden='true'></i>  </a><a class="menu-item" href="/hugo-loveit/pics/"><i class='fab fa-image fa-regular' aria-hidden='true'></i>  </a><a class="menu-item" href="https://twitter.com/dalehassinger" title="Twitter" rel="noopener noreffer" target="_blank"><i class='fab fa-twitter fa-fw' aria-hidden='true'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/hugo-loveit/" title="vCROCS"><span class="header-title-pre"><i class='far fa-house fa-solid'></i></span>vCROCS</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/hugo-loveit/about/" title="">About</a><a class="menu-item" href="/hugo-loveit/posts/" title="">Posts</a><a class="menu-item" href="/hugo-loveit/tags/" title="">Tags</a><a class="menu-item" href="/hugo-loveit/categories/" title="">Categories</a><a class="menu-item" href="/hugo-loveit/links/" title=""><i class='fab fa-bookmark fa-regular' aria-hidden='true'></i></a><a class="menu-item" href="/hugo-loveit/pics/" title=""><i class='fab fa-image fa-regular' aria-hidden='true'></i></a><a class="menu-item" href="https://twitter.com/dalehassinger" title="Twitter" rel="noopener noreffer" target="_blank"><i class='fab fa-twitter fa-fw' aria-hidden='true'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="page single special"><h1 class="single-title animate__animated animate__pulse animate__faster">VMware vRealize SaltStack Config as a Windows Server Admin - Part 1</h1><div class="content" id="content"><div>
  <b>Part 1: How to use SaltStack Config with Windows Server and PowerShell</b>
</div>
<div>
  <br>
</div>
<hr>
<div>
I have recently started looking at using <b>VMware vRealize SaltStack Config</b>. This blog is a work in progress on my journey with Salt. I started at **zero** and let's see what I discover as I work towards getting to <b>PROD**. So if this topic is interesting to you, check back often.  
<p>I wanted to learn one of the server configuration products that are available like Salt, Puppet, Chef, Ansible, etc&hellip; but I wasn&rsquo;t sure which would be the best choice long term.  When VMware purchased SaltStack Config the product to choose became a lot easier for me. SaltStack Config is included with vRealize Suite for licensing and I can call VMware support for help, SaltStack Config became the obvious product to pick.</p>
<p>I like to show how to use VMware vRealize Products from a <b>Windows Server Admin</b> point of view.  I do work with both Windows Servers and Linux Servers but most information you see online with Salt is using Linux Servers. I also do most of my current automation with PowerShell scripts. I do not want to lose all the time invested into the logic with my current PowerShell scripts.</p>
</div>
<hr>
<p>I am not going to go thru the process to install SaltStack Config.  There is already some very good blogs written on installing SaltStack Config. One item I would recommend with installing Salt-Stack Config is to use VMware vRealize Life Cycle Manager (&ldquo;LCM&rdquo;). LCM makes the process to install SaltStack Config a lot easier. This Blog is assuming you already installed SaltStack Config, now how do I use salt and what do I use salt for.</p>
<h6 id="a-hrefhttpsdocsvmwarecomenvrealize-automation84install-configure-saltstack-configguid-dbe6d84b-0d4b-4747-8291-b0d80851ce62html-target_blankinstalling-and-configuring-saltstack-configa"><a href="https://docs.vmware.com/en/vRealize-Automation/8.4/install-configure-saltstack-config/GUID-DBE6D84B-0D4B-4747-8291-B0D80851CE62.html" target="_blank">Installing and Configuring SaltStack Config</a></h6>
<hr>
<h6 id="the-first-step-minions">The first step (minions):</h6>
<p>After you get a working SaltStack Config Server setup, the first item you need to do is add the salt agent to some &ldquo;Test&rdquo; servers. Servers that have the salt agent installed are called minions. There is the option to not add the salt agent to servers but then you need to use SSH to connect.  Windows Servers do not have SSH available as default so you would need to install an SSH server like OpenSSH on your servers. My thoughts are I need to add something for the minions to communicate with the salt-master. Instead of adding OpenSSH to every Windows Server I chose to install and use the salt agent.</p>
<p>For testing you can manually install the minion agent on a server to become familiar with how the salt commands work. During the install there are two values you need to enter. The name of the master and the name you want to use for the minion. I did that on my first couple test servers but then I created some PowerShell code to install the salt minion agent.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># ----- [ Install minion ] -----------------------------------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Define Username/Password</span>
</span></span><span class="line"><span class="cl"><span class="nv">$username</span> <span class="p">=</span> <span class="s1">&#39;username@vCROCS.info&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># The next line is how to create the encrypted password</span>
</span></span><span class="line"><span class="cl"><span class="c"># Read-Host -Prompt &#34;Enter your password - username&#34; -AsSecureString | ConvertFrom-SecureString | Out-File &#34;C:\PWkey\username.key&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$password</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="s2">&#34;C:\PWkey\username.key&#34;</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span>
</span></span><span class="line"><span class="cl"><span class="nv">$cred</span> <span class="p">=</span> <span class="nb">new-object</span> <span class="n">-typename</span> <span class="n">System</span><span class="p">.</span><span class="py">Management</span><span class="p">.</span><span class="py">Automation</span><span class="p">.</span><span class="py">PSCredential</span> <span class="n">-argumentlist</span> <span class="nv">$username</span><span class="p">,</span> <span class="nv">$password</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># ----- [ This section connects you to vCenter where VM is located ] -----</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Connect to vCenter</span>
</span></span><span class="line"><span class="cl"><span class="n">vCenterName</span> <span class="p">=</span> <span class="s1">&#39;vCenter.vCROCS.info&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">Connect-VIServer</span> <span class="nv">$vCenterName</span> <span class="n">-Credential</span> <span class="nv">$cred</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># ----- [ Install Salt Agent ] -------------------------------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Name of Server to install the salt minion agent</span>
</span></span><span class="line"><span class="cl"><span class="nv">$vmName</span> <span class="p">=</span> <span class="s1">&#39;DBH-217&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Copy the minion agent file to your windows server</span>
</span></span><span class="line"><span class="cl"><span class="nb">Copy-VMGuestFile</span> <span class="n">-Source</span> <span class="n">G:</span><span class="p">\</span><span class="nb">Salt-Minion</span><span class="p">-</span><span class="mf">2019.2</span><span class="p">.</span><span class="mf">4</span><span class="n">-Py3-AMD64-Setup</span><span class="p">.</span><span class="py">exe</span> <span class="n">-Destination</span> <span class="s1">&#39;C:\vCROCS&#39;</span> <span class="n">-VM</span> <span class="nv">$vmName</span> <span class="n">-LocalToGuest</span> <span class="n">-GuestCredential</span> <span class="nv">$cred</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># command string to install the Salt Minion Agent</span>
</span></span><span class="line"><span class="cl"><span class="nv">$PSText</span> <span class="p">=</span> <span class="s1">&#39;C:\vCROCS\Salt-Minion-2019.2.4-Py3-AMD64-Setup.exe /S /master=salt /minion-name=&#39;</span> <span class="p">+</span> <span class="nv">$vmName</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Run the command on remote Server</span>
</span></span><span class="line"><span class="cl"><span class="nb">Invoke-VMScript</span> <span class="n">-VM</span> <span class="nv">$VMName</span> <span class="n">-ScriptType</span> <span class="n">bat</span> <span class="n">-ScriptText</span> <span class="nv">$PSText</span> <span class="n">-GuestCredential</span> <span class="nv">$cred</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>After the minion agent is installed on your server you need to accept the key on the salt master. From the CLI you can run these commands.</p>
<p>List all keys. You should see you new minion listed in the Unaccepted Keys:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">salt-key</span> <span class="n">-L</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>Accept the new minion key on the salt master:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">salt-key</span> <span class="p">-</span><span class="n">-accept</span><span class="p">=</span><span class="s2">&#34;DBH-217&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>If you list all keys again you should see you new minion listed in the Accepted Keys:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">salt-key</span> <span class="n">-L</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>My next update will include information on how to auto accept new minions.</p>
<hr>
<h6 id="here-are-some-basic-salt-commands-from-cli-that-i-have-been-using">Here are some basic salt commands from CLI that I have been using:</h6>
<p><strong>Show all events:</strong><br>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">salt-run</span> <span class="n">state</span><span class="p">.</span><span class="n">event</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><a class="lightgallery" href="images/post/salt-03.png" title="images/post/salt-03.png" data-thumbnail="images/post/salt-03.png">
        <img
            class="lazyload"
            src="/hugo-loveit/svg/loading.min.svg"
            data-src="images/post/salt-03.png"
            data-srcset="images/post/salt-03.png, images/post/salt-03.png 1.5x, images/post/salt-03.png 2x"
            data-sizes="auto"
            alt="images/post/salt-03.png" />
    </a>
<a href="https://github.com/dalehassinger/geeky/raw/main/assets/images/post/salt-03.png" target="_blank">Click Here to see Larger Image of Screen Shot</a></p>
<p><strong>Show all events with a &ldquo;Pretty&rdquo; view:</strong><br>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">salt-run</span> <span class="n">state</span><span class="p">.</span><span class="py">event</span> <span class="n">pretty</span><span class="p">=</span><span class="n">true</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><a class="lightgallery" href="images/post/salt-02.png" title="images/post/salt-02.png" data-thumbnail="images/post/salt-02.png">
        <img
            class="lazyload"
            src="/hugo-loveit/svg/loading.min.svg"
            data-src="images/post/salt-02.png"
            data-srcset="images/post/salt-02.png, images/post/salt-02.png 1.5x, images/post/salt-02.png 2x"
            data-sizes="auto"
            alt="images/post/salt-02.png" />
    </a>
<a href="https://github.com/dalehassinger/geeky/raw/main/assets/images/post/salt-02.png" target="_blank">Click Here to see Larger Image of Screen Shot</a></p>
<p><strong>List keys:</strong><br>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">salt-key</span> <span class="n">-L</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Accept Key:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">salt-key</span> <span class="p">-</span><span class="n">-accept</span><span class="p">=</span><span class="s2">&#34;DBH-214&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Delete Key:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">salt-key</span> <span class="n">-d</span> <span class="s2">&#34;DBH-211,DBH-212&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Run a function on one minion:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">salt</span> <span class="s2">&#34;DBH-217&#34;</span> <span class="n">disk</span><span class="p">.</span><span class="n">usage</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Run a function on multiple minions:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">salt</span> <span class="s2">&#34;DBH-217,DBH-218&#34;</span> <span class="n">test</span><span class="p">.</span><span class="n">ping</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Run a function on all minions:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">salt</span> <span class="s2">&#34;*&#34;</span> <span class="n">test</span><span class="p">.</span><span class="n">ping</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Create a file:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">salt</span> <span class="s2">&#34;DBH-214&#34;</span> <span class="n">file</span><span class="p">.</span><span class="py">touch</span> <span class="n">C:</span><span class="p">\</span><span class="n">vCROCS</span><span class="p">\</span><span class="n">salt</span><span class="p">.</span><span class="n">tst</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Copy a file:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">salt</span> <span class="s2">&#34;DBH-214&#34;</span> <span class="n">cp</span><span class="p">.</span><span class="py">get_file</span> <span class="n">salt</span><span class="err">:</span><span class="p">//</span><span class="n">vCROCS</span><span class="p">/</span><span class="n">vCROCSTEST</span><span class="p">.</span><span class="py">ps1</span> <span class="s2">&#34;C:\vCROCS\vCROCSTEST.ps1&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Delete a file:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">salt</span> <span class="s2">&#34;DBH-214&#34;</span> <span class="n">file</span><span class="p">.</span><span class="py">remove</span> <span class="s2">&#34;C:\vCROCS\vCROCSTEST.ps1&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Run a PowerShell Script:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">salt</span> <span class="s2">&#34;DBH-214&#34;</span> <span class="n">cmd</span><span class="p">.</span><span class="py">script</span> <span class="n">source</span><span class="p">=</span><span class="s2">&#34;salt://vCROCS/vCROCSTEST.ps1&#34;</span> <span class="n">shell</span><span class="p">=</span><span class="n">powershell</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Restart the Salt Master Service:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">service</span> <span class="nb">salt-master</span> <span class="n">restart</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Show the status of the raas and salt-master services:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="n">status</span> <span class="n">raas</span>
</span></span><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="n">status</span> <span class="nb">salt-master</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Stop and start the salt-master service:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="n">stop</span> <span class="nb">salt-master</span>
</span></span><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="nb">start salt-master</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Get IP address of all minions:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">salt</span> <span class="s1">&#39;*&#39;</span> <span class="n">network</span><span class="p">.</span><span class="n">ip_addrs</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Ping All Minions:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">salt</span> <span class="s2">&#34;*&#34;</span> <span class="n">test</span><span class="p">.</span><span class="n">ping</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Disk Space Usage on all Minions:</strong>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">salt</span> <span class="s2">&#34;*&#34;</span> <span class="n">disk</span><span class="p">.</span><span class="n">usage</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<hr>
<h6 id="lessons-learned">Lessons Learned:</h6>
<ul>
<li>Anything you can do in the SaltStack Config GUI you can do in CLI. I find myself using the CLI for most testing. After I have the commands correct I will then add into the GUI.</li>
<li>DO NOT have the minion agent version newer than the Salt-Master. I am going to try and keep the salt-master and minions always at the same version. The minion can be at an older version than the salt-master.</li>
<li>During my upgrade from SaltStack Config 8.3 to 8.4 the Salt API did not upgrade. I didn&rsquo;t remember seeing any errors in LCM after the upgrade. The raas service was at version 8.4 and the salt API was at 8.3.  I had authentication issues, I could not accept keys, etc&hellip; I opened an SR with VMware and they helped me fix the issue. The support I received from VMware with Salt was probably the best support I received on any VMware product.</li>
</ul>
<hr>
<h6 id="salt-links-i-found-to-be-very-helpful">Salt Links I found to be very helpful:</h6>
<ul>
<li><a href="https://sites.google.com/site/mrxpalmeiras/saltstack/salt-cheat-sheet" target="_blank">SaltStack Cheat Sheet</a></li>
<li><a href="https://docs.saltproject.io/en/getstarted/"                            target="_blank">SaltStack Tutorials</a></li>
<li><a href="https://docs.saltproject.io/en/latest/contents.html"                   target="_blank">SaltStack Documentation</a></li>
<li><a href="https://saltstackcommunity.slack.com"                                  target="_blank">SaltStack Community Slack Channel</a></li>
<li><a href="https://learnvrealizeautomation.github.io"                             target="_blank">Learn vRealize Automation</a></li>
<li><a href="https://learnsaltstackconfig.github.io/"                               target="_blank">Learn SaltStack Config</a></li>
</ul>
<div style="background-color:#ccffcc; Padding:20px;" >
When I write about <b>vRealize Automation</b> ("vRA") I always say there are many ways to accomplish the same task.  <b>SaltStack Config</b> is the same way.  I am showing what I felt was important to see but every organization/environment will be different. There is no right or wrong way to use Salt. This is a <b>GREAT Tool</b> that is included with your vRealize Suite Advanced/Enterprise license. If you own the vRealize Suite, you own SaltStack Config.
</div></div><div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Designed | Developed By vCROCS</div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/hugo-loveit/" target="_blank">| Dale Hassinger</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://www.vCROCS.info" target="_blank">www.vCROCS.info</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://vcrocs.disqus.com/embed.js" defer></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/hugo-loveit/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/hugo-loveit/js/theme.min.js"></script></body>
</html>
